{% extends 'template.html'%} {%block titulo%} Grupos {%endblock%} {%block
cuerpo%}

<script>
  function crear_grupo() {
    location.replace("/grupo/crear");
  }

  function filtrar(filtrado) {

    var jsonData = { filtro: filtrado.value };


    fetch("/api/filtrar_grupo", {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(jsonData)
    }
    )

      .then(response => response.json())

      .then(data => {
        var tabla = document.querySelector("tbody");
        var filas = tabla.getElementsByTagName("tr");

        // Verifica si hay mÃ¡s de una fila (excluye la fila de encabezado)
        for (var i = filas.length - 1; i >= 0; i--) {
          tabla.deleteRow(i);
        }

        var llaves = Object.keys(data.json);
        llaves.forEach(grupo => {

          var fila = tabla.insertRow();
          var celda1 = fila.insertCell();
          var celda2 = fila.insertCell();
          var celda3 = fila.insertCell();
          var celda4 = fila.insertCell();
          var celda5 = fila.insertCell();
          var celda6 = fila.insertCell();
          var celda7 = fila.insertCell();

          celda1.innerHTML = data["json"][grupo].codigo;

          celda2.innerHTML = data["json"][grupo].nombre;
          celda3.innerHTML = data["json"][grupo].docente;
          celda4.innerHTML = data["json"][grupo].curso;
          celda5.innerHTML = data["json"][grupo].horario;
          celda6.innerHTML = data["json"][grupo].dias;

          celda7.innerHTML = "<a href='/grupo/ver/" + data["json"][grupo].codigo + "' class='iconos'><i class='fa-regular fa-eye' style='color: #08f'></i></a><a href='/grupo/editar/" + data["json"][grupo].codigo + "' class='iconos'><i class='fa-regular fa-pen-to-square' style='color: #08f'></i></a><a href='/grupo/eliminar/" + data["json"][grupo].codigo + "' class='iconos'><i class='fa-solid fa-trash' style='color: #08f'></i></a>"


        });
      })
  }

</script>



<div style="height: 100vh" class="d-flex justify-content-center align-items-center flex-column">
  <div style="width: 100%" class="d-flex justify-content-between align-items-center">
    <p class="fs-2">Listado De Grupos</p>
    <div class="d-flex justify-content-center align-items-center">
      <button type="button" onclick="crear_grupo()" class="btn btn-outline-primary" style="width: 210px">
        Crear Grupo
      </button>
      <input id="filtrado" oninput="filtrar(this)" type="text" class="form-control mx-2" aria-label="Text input with checkbox" />
    </div>
  </div>
  <table class="table">
    <thead class="table-dark">
      <tr>
        <th scope="col">Codigo</th>
        <th scope="col">Nombre</th>
        <th scope="col">Docente</th>
        <th scope="col">Curso</th>
        <th scope="col">Hoario</th>
        <th scope="col">Dias</th>
        <th scope="col">Funcionalidades</th>
      </tr>
    </thead>
    <tbody>

      {%for i in lista%}
      <tr>
        <td scope="col">{{i["codigo"]}}</td>
        <td scope="col">{{i["nombre"]}}</td>
        <td scope="col">{{i["docente"]}}</td>
        <td scope="col">{{i["curso"]}}</td>
        <td scope="col">{{i["horario"]}}</td>
        <td scope="col">{{i["dias"]}}</td>
        <td>
          <a href="/grupo/ver/{{i.codigo}}" class="iconos">
            <i class="fa-regular fa-eye" style="color: #08f"></i>
          </a>
          <a href="/grupo/editar/{{i.codigo}}" class="iconos">
            <i class="fa-regular fa-pen-to-square" style="color: #08f"></i>
          </a>
          <a href="/grupo/eliminar/{{i.codigo}}" class="iconos">
            <i class="fa-solid fa-trash" style="color: #08f"></i>
          </a>
        </td>
      </tr>
      {%endfor%}
    </tbody>
  </table>
  {%endblock%}
</div>